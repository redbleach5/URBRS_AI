{"value": "512-Ius2VYcGNk7T90CppJqcIkS5ooHUZyIQK+ClZfMfMNFEF9VSE73Fq+906u/CWu92x4gzZMWOwfFYckPObzdEbA==\",\n      \"dev\": true,\n      \"license\": \"ISC\"\n    },\n    \"node_modules/imurmurhash\": {\n      \"version\": \"0.1.4\",\n      \"resolved\": \"https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz\",\n      \"integrity\": \"sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==\",\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"engines\": {\n        \"node\": \">=0.8.19\"\n      }\n    },\n    \"node_modules/indent-string\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/indent-string/-/indent-string-4.0.0.tgz\",\n      \"integrity\": \"sha512-EdDDZu4A2OyIK7Lr/2zG+w5jmbuk1DVBnEwREQvBzspBJkCEbRa8GxU1lghYcaGJCnRWibjDXlq779X1/y5xwg==\",\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/infer-owner\": {\n      \"version\": \"1.0.4\",\n      \"resolved\": \"https://registry.npmjs.org/infer-owner/-/infer-owner-1.0.4.tgz\",\n      \"integrity\": \"sha512-IClj+Xz94+d7irH5qRyfJonOdfTzuDaifE6ZPWfx0N0+/ATZCbuTPq2prFl526urkQd90WyUKIh1DfBQ2hMz9A==\",\n      \"license\": \"ISC\",\n      \"optional\": true\n    },\n    \"node_modules/inflight\": {\n      \"version\": \"1.0.6\",\n      \"resolved\": \"https://registry.npmjs.org/inflight/-/inflight-1.0.6.tgz\",\n      \"integrity\": \"sha512-k92I/b08q4wvFscXCLvqfsHCrjrF7yiXsQuIVvVE7N82W3+aqpzuUdBbfhWcy/FZR3/4IgflMgKLOsvPDrGCJA==\",\n      \"deprecated\": \"This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.\",\n      \"license\": \"ISC\",\n      \"optional\": true,\n      \"dependencies\": {\n        \"once\": \"^1.3.0\",\n        \"wrappy\": \"1\"\n      }\n    },\n    \"node_modules/inherits\": {\n      \"version\": \"2.0.4\",\n      \"resolved\": \"https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz\",\n      \"integrity\": \"sha512-k/vGaX4/Yla3WzyMC\n\n#!/usr/bin/env node\n\n/**\n * \u0421\u043a\u0440\u0438\u043f\u0442 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f IP \u0430\u0434\u0440\u0435\u0441\u0430 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438\n * \u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430 \u0432\u0441\u0435\u0445 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430\u0445 (macOS, Linux, Windows)\n */\n\nconst os = require('os');\nconst { execSync } = require('child_process');\n\nconsole.log('\ud83d\udd0d \u041f\u043e\u0438\u0441\u043a IP \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0438\u0437 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438...\\n');\n\nfunction getIPAddresses() {\n  const interfaces = os.networkInterfaces();\n  const addresses = [];\n\n  for (const name of Object.keys(interfaces)) {\n    for (const iface of interfaces[name]) {\n      // \u041f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u0438 \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0430\u0434\u0440\u0435\u0441\u0430\n      if (iface.family === 'IPv4' && !iface.internal) {\n        // \u041f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c loopback \u0438 link-local \u0430\u0434\u0440\u0435\u0441\u0430\n        if (!iface.address.startsWith('127.') && !iface.address.startsWith('169.254.')) {\n          addresses.push({\n            address: iface.address,\n            interface: name\n          });\n        }\n      }\n    }\n  }\n\n  return addresses;\n}\n\nconst addresses = getIPAddresses();\n\nif (addresses.length > 0) {\n  console.log('\ud83d\udcf1 \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0430\u0434\u0440\u0435\u0441\u0430:');\n  addresses.forEach(({ address, interface: iface }) => {\n    console.log(`   http://${address}:3000`);\n    console.log(`      (\u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441: ${iface})`);\n  });\n  console.log('');\n  console.log('\ud83d\udca1 \u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u0437 \u044d\u0442\u0438\u0445 \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435');\n  console.log('   \u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u0432 \u043e\u0434\u043d\u043e\u0439 Wi-Fi \u0441\u0435\u0442\u0438!');\n} else {\n  console.log('\u274c \u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432');\n}\n\n\n\n#!/usr/bin/env node\n\n/**\n * \u0421\u043a\u0440\u0438\u043f\u0442 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f IP \u0430\u0434\u0440\u0435\u0441\u0430 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438\n * \u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430 \u0432\u0441\u0435\u0445 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430\u0445 (macOS, Linux, Windows)\n */\n\nconst os = require('os');\nconst { execSync } = require('child_process');\n\nconsole.log('\ud83d\udd0d \u041f\u043e\u0438\u0441\u043a IP \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0438\u0437 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438...\\n');\n\nfunction getIPAddresses() {\n  const interfaces = os.networkInterfaces();\n  const addresses = [];\n\n  for (const name of Object.keys(interfaces)) {\n    for (const iface of interfaces[name]) {\n      // \u041f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u0438 \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0430\u0434\u0440\u0435\u0441\u0430\n      if (iface.family === 'IPv4' && !iface.internal) {\n        // \u041f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c loopback \u0438 link-local \u0430\u0434\u0440\u0435\u0441\u0430\n        if (!iface.address.startsWith('127.') && !iface.address.startsWith('169.254.')) {\n          addresses.push({\n            address: iface.address,\n            interface: name\n          });\n        }\n      }\n    }\n  }\n\n  return addresses;\n}\n\nconst addresses = getIPAddresses();\n\nif (addresses.length > 0) {\n  console.log('\ud83d\udcf1 \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0430\u0434\u0440\u0435\u0441\u0430:');\n  addresses.forEach(({ address, interface: iface }) => {\n    console.log(`   http://${address}:3000`);\n    console.log(`      (\u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441: ${iface})`);\n  });\n  console.log('');\n  console.log('\ud83d\udca1 \u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u0437 \u044d\u0442\u0438\u0445 \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435');\n  console.log('   \u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u0432 \u043e\u0434\u043d\u043e\u0439 Wi-Fi \u0441\u0435\u0442\u0438!');\n} else {\n  console.log('\u274c \u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432');\n}\n\n\n\nimport express from 'express';\nimport bcrypt from 'bcryptjs';\nimport jwt from 'jsonwebtoken';\nimport crypto from 'crypto';\nimport rateLimit from 'express-rate-limit';\nimport { dbGet, dbRun } from '../database';\nimport { authenticate, AuthRequest } from '../middleware/auth';\nimport { logger, loggerManager } from '../utils/logger';\nimport { User, UserPublic } from '../types/database';\nimport { asyncHandler } from '../middleware/errorHandler';\nimport type { AuthResponse, User as SharedUser } from '../../shared/types';\n\n// \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 JWT_SECRET \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043c\u043e\u0434\u0443\u043b\u044f\nif (!process.env.JWT_SECRET && process.env.NODE_ENV === 'production') {\n  throw new Error('JWT_SECRET must be set in production environment');\n}\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'secret';\n\n// Rate limiting \u0434\u043b\u044f auth endpoints\nconst loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 \u043c\u0438\u043d\u0443\u0442\n  max: 5, // 5 \u043f\u043e\u043f\u044b\u0442\u043e\u043a\n  message: '\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043c\u043d\u043e\u0433\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u0432\u0445\u043e\u0434\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.',\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\nconst registerLimiter = rateLimit({\n  windowMs: 60 * 60 * 1000, // 1 \u0447\u0430\u0441\n  max: 3, // 3 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438\n  message: '\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043c\u043d\u043e\u0433\u043e \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.',\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\nconst resetPasswordLimiter = rateLimit({\n  windowMs: 60 * 60 * 1000, // 1 \u0447\u0430\u0441\n  max: 3, // 3 \u043f\u043e\u043f\u044b\u0442\u043a\u0438\n  message: '\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043c\u043d\u043e\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043d\u0430 \u0441\u0431\u0440\u043e\u0441 \u043f\u0430\u0440\u043e\u043b\u044f. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.',\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\nconst router = express.Router();\n\n// \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 email\nfunction isValidEmail(email: string): boolean {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n}\n\n// \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 \u043f\u0430\u0440\u043e\u043b\u044f\nfunction isValidPassword(password: string): { valid: boolean; error?: string } {\n  if (password.length < 8) {\n    return { valid: false, error: '\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 8 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432' };\n  }\n  if (password.length > 128) {\n    return { valid: false, error: '\u041f\u0430\u0440\u043e\u043b\u044c \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0442\u044c 128 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432' };\n  }\n\n#!/usr/bin/env node\n\n/**\n * \u0421\u043a\u0440\u0438\u043f\u0442 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f IP \u0430\u0434\u0440\u0435\u0441\u0430 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0432 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438\n * \u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430 \u0432\u0441\u0435\u0445 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430\u0445 (macOS, Linux, Windows)\n */\n\nconst os = require('os');\nconst { execSync } = require('child_process');\n\nconsole.log('\ud83d\udd0d \u041f\u043e\u0438\u0441\u043a IP \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0438\u0437 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438...\\n');\n\nfunction getIPAddresses() {\n  const interfaces = os.networkInterfaces();\n  const addresses = [];\n\n  for (const name of Object.keys(interfaces)) {\n    for (const iface of interfaces[name]) {\n      // \u041f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u0438 \u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0430\u0434\u0440\u0435\u0441\u0430\n      if (iface.family === 'IPv4' && !iface.internal) {\n        // \u041f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c loopback \u0438 link-local \u0430\u0434\u0440\u0435\u0441\u0430\n        if (!iface.address.startsWith('127.') && !iface.address.startsWith('169.254.')) {\n          addresses.push({\n            address: iface.address,\n            interface: name\n          });\n        }\n      }\n    }\n  }\n\n  return addresses;\n}\n\nconst addresses = getIPAddresses();\n\nif (addresses.length > 0) {\n  console.log('\ud83d\udcf1 \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0430\u0434\u0440\u0435\u0441\u0430:');\n  addresses.forEach(({ address, interface: iface }) => {\n    console.log(`   http://${address}:3000`);\n    console.log(`      (\u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441: ${iface})`);\n  });\n  console.log('');\n  console.log('\ud83d\udca1 \u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u0437 \u044d\u0442\u0438\u0445 \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u043d\u0430 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435');\n  console.log('   \u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430 \u0432 \u043e\u0434\u043d\u043e\u0439 Wi-Fi \u0441\u0435\u0442\u0438!');\n} else {\n  console.log('\u274c \u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432');\n}\n\n\n\n    while (pos < text.length) {\n      if (text[pos] === '[') bracketCount++;\n      else if (text[pos] === ']') {\n        bracketCount--;\n        if (bracketCount === 0) {\n          // \u041d\u0430\u0448\u043b\u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u044e\u0449\u0443\u044e \u0441\u043a\u043e\u0431\u043a\u0443 \u0434\u043b\u044f \u043d\u0430\u0448\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b\n          const content = text.substring(contentStart, pos);\n          commands.push(content);\n          foundEnd = true;\n          startIndex = pos + 1;\n          break;\n        }\n      }\n      pos++;\n    }\n    \n    if (!foundEnd) {\n      // \u041d\u0435 \u043d\u0430\u0448\u043b\u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u044e\u0449\u0443\u044e \u0441\u043a\u043e\u0431\u043a\u0443 - \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u044d\u0442\u0443 \u043a\u043e\u043c\u0430\u043d\u0434\u0443\n      startIndex = contentStart + 1;\n    }\n  }\n  \n  return commands;\n}\n\n// \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0438\u0437 \u043e\u0442\u0432\u0435\u0442\u0430 AI\nasync function executeActions(response: string, userId: number): Promise<string[]> {\n  const results: string[] = [];\n  \n  // \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u0441\u0438\u043d\u0433 \u043a\u043e\u043c\u0430\u043d\u0434\n  const folderCommands = extractActionCommand(response, 'CREATE_FOLDER');\n  const fileCommands = extractActionCommand(response, 'CREATE_FILE');\n  const deleteFileCommands = extractActionCommand(response, 'DELETE_FILE');\n  const deleteFolderCommands = extractActionCommand(response, 'DELETE_FOLDER');\n  \n  // \u0425\u0440\u0430\u043d\u0438\u043c \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0430\u043f\u043a\u0438 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\n  const createdFolders = new Set<string>();\n  \n  // \u041e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f: \u0431\u0430\u0442\u0447\u0438\u043d\u0433 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0430\u043f\u043e\u043a\n  if (folderCommands.length > 0) {\n    // \u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0438 \u0441\u0430\u043d\u0438\u0442\u0438\u0437\u0430\u0446\u0438\u044f\n    const validFolders: Array<{ original: string; sanitized: string }> = [];\n    for (const commandContent of folderCommands) {\n      const folderName = commandContent.trim();\n      if (!folderName || folderName.length === 0) {\n        results.push('\u041e\u0448\u0438\u0431\u043a\u0430: \u0438\u043c\u044f \u043f\u0430\u043f\u043a\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c');\n        continue;\n      }\n      if (folderName.length > 255) {\n        results.push(`\u041e\u0448\u0438\u0431\u043a\u0430: \u0438\u043c\u044f \u043f\u0430\u043f\u043a\u0438 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0434\u043b\u0438\u043d\u043d\u043e\u0435 (\u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 255 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)`);\n        continue;\n      }\n      try {\n        const sanitized = sanitizeFilename(folderName);\n        validFolders.push({ original: folderName, sanitized });\n      } catch (error: any) {\n\n    while (pos < text.length) {\n      if (text[pos] === '[') bracketCount++;\n      else if (text[pos] === ']') {\n        bracketCount--;\n        if (bracketCount === 0) {\n          // \u041d\u0430\u0448\u043b\u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u044e\u0449\u0443\u044e \u0441\u043a\u043e\u0431\u043a\u0443 \u0434\u043b\u044f \u043d\u0430\u0448\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b\n          const content = text.substring(contentStart, pos);\n          commands.push(content);\n          foundEnd = true;\n          startIndex = pos + 1;\n          break;\n        }\n      }\n      pos++;\n    }\n    \n    if (!foundEnd) {\n      // \u041d\u0435 \u043d\u0430\u0448\u043b\u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u044e\u0449\u0443\u044e \u0441\u043a\u043e\u0431\u043a\u0443 - \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u044d\u0442\u0443 \u043a\u043e\u043c\u0430\u043d\u0434\u0443\n      startIndex = contentStart + 1;\n    }\n  }\n  \n  return commands;\n}\n\n// \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0438\u0437 \u043e\u0442\u0432\u0435\u0442\u0430 AI\nasync function executeActions(response: string, userId: number): Promise<string[]> {\n  const results: string[] = [];\n  \n  // \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u0441\u0438\u043d\u0433 \u043a\u043e\u043c\u0430\u043d\u0434\n  const folderCommands = extractActionCommand(response, 'CREATE_FOLDER');\n  const fileCommands = extractActionCommand(response, 'CREATE_FILE');\n  const deleteFileCommands = extractActionCommand(response, 'DELETE_FILE');\n  const deleteFolderCommands = extractActionCommand(response, 'DELETE_FOLDER');\n  \n  // \u0425\u0440\u0430\u043d\u0438\u043c \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0430\u043f\u043a\u0438 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\n  const createdFolders = new Set<string>();\n  \n  // \u041e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f: \u0431\u0430\u0442\u0447\u0438\u043d\u0433 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0430\u043f\u043e\u043a\n  if (folderCommands.length > 0) {\n    // \u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0438 \u0441\u0430\u043d\u0438\u0442\u0438\u0437\u0430\u0446\u0438\u044f\n    const validFolders: Array<{ original: string; sanitized: string }> = [];\n    for (const commandContent of folderCommands) {\n      const folderName = commandContent.trim();\n      if (!folderName || folderName.length === 0) {\n        results.push('\u041e\u0448\u0438\u0431\u043a\u0430: \u0438\u043c\u044f \u043f\u0430\u043f\u043a\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c');\n        continue;\n      }\n      if (folderName.length > 255) {\n        results.push(`\u041e\u0448\u0438\u0431\u043a\u0430: \u0438\u043c\u044f \u043f\u0430\u043f\u043a\u0438 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0434\u043b\u0438\u043d\u043d\u043e\u0435 (\u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 255 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)`);\n        continue;\n      }\n      try {\n        const sanitized = sanitizeFilename(folderName);\n        validFolders.push({ original: folderName, sanitized });\n      } catch (error: any) {\n\n      // \u041f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u0441\u043f\u0438\u0441\u043e\u043a \u0441 \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u043e\u0439\n      setTimeout(() => {\n        loadFiles(parentId, true);\n      }, 200);\n      setRenamingFile(null);\n      setNewFileName('');\n    } catch (error) {\n      clientLogger.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f', error, 'files');\n    }\n  };\n\n  const startRename = (file: FileItem) => {\n    setRenamingFile(file.id);\n    setNewFileName(file.name);\n  };\n\n  const handleContextMenu = (e: React.MouseEvent | React.TouchEvent, file: FileItem) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const clientX = 'clientX' in e ? e.clientX : e.touches[0].clientX;\n    const clientY = 'clientY' in e ? e.clientY : e.touches[0].clientY;\n    setContextMenu({\n      x: clientX,\n      y: clientY,\n      file\n    });\n  };\n\n  // \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0434\u043e\u043b\u0433\u043e\u0433\u043e \u043d\u0430\u0436\u0430\u0442\u0438\u044f \u0434\u043b\u044f \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\n  const [longPressTimer, setLongPressTimer] = useState<NodeJS.Timeout | null>(null);\n  const touchStartRef = React.useRef<{ file: FileItem | null; time: number; x: number; y: number }>({ file: null, time: 0, x: 0, y: 0 });\n  \n  const handleTouchStart = (e: React.TouchEvent, file: FileItem) => {\n    const touch = e.touches[0];\n    touchStartRef.current = {\n      file,\n      time: Date.now(),\n      x: touch.clientX,\n      y: touch.clientY\n    };\n    \n    // \u0414\u043e\u043b\u0433\u043e\u0435 \u043d\u0430\u0436\u0430\u0442\u0438\u0435 \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442 \u0440\u0435\u0436\u0438\u043c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0438\u043b\u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u043e\u0435 \u043c\u0435\u043d\u044e\n    const timer = setTimeout(() => {\n      // \u0415\u0441\u043b\u0438 \u0444\u0430\u0439\u043b \u043d\u0435 \u0432\u044b\u0434\u0435\u043b\u0435\u043d, \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u043c \u0440\u0435\u0436\u0438\u043c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f\n      if (!selectedFiles.has(file.id) && !selectionMode) {\n        activateSelectionMode(file);\n        // \u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043e\u0431\u0440\u0430\u0442\u043d\u0443\u044e \u0441\u0432\u044f\u0437\u044c\n        toast.success('\u0420\u0435\u0436\u0438\u043c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d', { duration: 1500 });\n      } else {\n        // \u0415\u0441\u043b\u0438 \u0443\u0436\u0435 \u0432 \u0440\u0435\u0436\u0438\u043c\u0435 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0438\u043b\u0438 \u0444\u0430\u0439\u043b \u0432\u044b\u0434\u0435\u043b\u0435\u043d, \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u043e\u0435 \u043c\u0435\u043d\u044e\n        handleContextMenu(e, file);\n      }\n    }, 500); // 500ms \u0434\u043b\u044f \u0434\u043e\u043b\u0433\u043e\u0433\u043e \u043d\u0430\u0436\u0430\u0442\u0438\u044f\n    setLongPressTimer(timer);\n  };\n\n  const handleTouchEnd = (e: React.TouchEvent) => {\n    const wasLongPress = !!longPressTimer;\n    \n\n    while (pos < text.length) {\n      if (text[pos] === '[') bracketCount++;\n      else if (text[pos] === ']') {\n        bracketCount--;\n        if (bracketCount === 0) {\n          // \u041d\u0430\u0448\u043b\u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u044e\u0449\u0443\u044e \u0441\u043a\u043e\u0431\u043a\u0443 \u0434\u043b\u044f \u043d\u0430\u0448\u0435\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b\n          const content = text.substring(contentStart, pos);\n          commands.push(content);\n          foundEnd = true;\n          startIndex = pos + 1;\n          break;\n        }\n      }\n      pos++;\n    }\n    \n    if (!foundEnd) {\n      // \u041d\u0435 \u043d\u0430\u0448\u043b\u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u044e\u0449\u0443\u044e \u0441\u043a\u043e\u0431\u043a\u0443 - \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u044d\u0442\u0443 \u043a\u043e\u043c\u0430\u043d\u0434\u0443\n      startIndex = contentStart + 1;\n    }\n  }\n  \n  return commands;\n}\n\n// \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0438\u0437 \u043e\u0442\u0432\u0435\u0442\u0430 AI\nasync function executeActions(response: string, userId: number): Promise<string[]> {\n  const results: string[] = [];\n  \n  // \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u0441\u0438\u043d\u0433 \u043a\u043e\u043c\u0430\u043d\u0434\n  const folderCommands = extractActionCommand(response, 'CREATE_FOLDER');\n  const fileCommands = extractActionCommand(response, 'CREATE_FILE');\n  const deleteFileCommands = extractActionCommand(response, 'DELETE_FILE');\n  const deleteFolderCommands = extractActionCommand(response, 'DELETE_FOLDER');\n  \n  // \u0425\u0440\u0430\u043d\u0438\u043c \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0430\u043f\u043a\u0438 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\n  const createdFolders = new Set<string>();\n  \n  // \u041e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f: \u0431\u0430\u0442\u0447\u0438\u043d\u0433 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0430\u043f\u043e\u043a\n  if (folderCommands.length > 0) {\n    // \u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0438 \u0441\u0430\u043d\u0438\u0442\u0438\u0437\u0430\u0446\u0438\u044f\n    const validFolders: Array<{ original: string; sanitized: string }> = [];\n    for (const commandContent of folderCommands) {\n      const folderName = commandContent.trim();\n      if (!folderName || folderName.length === 0) {\n        results.push('\u041e\u0448\u0438\u0431\u043a\u0430: \u0438\u043c\u044f \u043f\u0430\u043f\u043a\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c');\n        continue;\n      }\n      if (folderName.length > 255) {\n        results.push(`\u041e\u0448\u0438\u0431\u043a\u0430: \u0438\u043c\u044f \u043f\u0430\u043f\u043a\u0438 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0434\u043b\u0438\u043d\u043d\u043e\u0435 (\u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 255 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)`);\n        continue;\n      }\n      try {\n        const sanitized = sanitizeFilename(folderName);\n        validFolders.push({ original: folderName, sanitized });\n      } catch (error: any) {\n\n          if (issue.code) md += `  - \u041a\u043e\u0434: \\`\\`\\`${issue.code}\\`\\`\\`\\n`;\n          if (issue.suggestion) md += `  - \ud83d\udca1 ${issue.suggestion}\\n`;\n          md += `\\n`;\n        });\n      }\n    }\n\n    if (this.config.reports.includeSuggestions && result.suggestions.length > 0) {\n      md += `## \u041f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f\\n\\n`;\n      result.suggestions.forEach((s: any) => {\n        md += `### ${s.title}\\n\\n`;\n        md += `**\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442:** ${s.priority}\\n`;\n        md += `${s.description}\\n\\n`;\n        if (s.codeExample) md += `\\`\\`\\`\\n${s.codeExample}\\n\\`\\`\\`\\n\\n`;\n      });\n    }\n\n    const outputPath = path.join(this.config.reports.outputDir, `report-${Date.now()}.md`);\n    fs.writeFileSync(outputPath, md);\n    console.log(`\ud83d\udcc4 Markdown \u043e\u0442\u0447\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d: ${outputPath}`);\n  }\n\n  /**\n   * \u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f JSON \u043e\u0442\u0447\u0435\u0442\u0430\n   */\n  private async generateJSON(result: CuratorResult): Promise<void> {\n    const outputPath = path.join(this.config.reports.outputDir, `report-${Date.now()}.json`);\n    fs.writeFileSync(outputPath, JSON.stringify(result, null, 2));\n    console.log(`\ud83d\udcc4 JSON \u043e\u0442\u0447\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d: ${outputPath}`);\n  }\n}\n", "timestamp": 1767393598.727946, "ttl": 3600}